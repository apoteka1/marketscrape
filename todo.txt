make async, 
wrap in one function 
add changeable upper / lower limits
remove dups in analysis